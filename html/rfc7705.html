<!DOCTYPE html>


<html lang="zh">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>RFC 7705 - Autonomous System Migration Mechanisms and Their Effects on the BGP AS_PATH Attribute 中文翻译</title>

  
  <link rel="shortcut icon" type="image/x-icon" href="https://rfc.idv.tw/favicon.ico" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/css/bootstrap.min.css" integrity="sha256-+IZRbz1B6ee9mUx/ejmonK+ulIP5A5bLDd6v6NHqXnI=" crossorigin="anonymous">

  <link rel="stylesheet" type="text/css" href="master.css">
  <script type="text/javascript" src="index.js"></script>

</head>
<body>
  
  <nav class="navbar navbar-expand navbar-light bg-light">
    <a class="navbar-brand" href="index.html">RFC Trans</a>
    <div class="collapse navbar-collapse" id="navbarText">
      <div class="navbar-nav mr-auto">
        <a class="nav-item nav-link" href="draft/index.html">Draft</a>
        <a class="nav-item nav-link" href="figs/index.html">Figs</a>
        <a class="nav-item nav-link" href="copyright.html">Copyright</a>
      </div>
      <div class="navbar-nav ml-auto">
        <span class="navbar-text"><small>@trustywolf</small></span>
      </div>
    </div>
  </nav>

  <span id="rfc_number" class="hidden">7705</span>
  <div style="height: 1ex;"></div>
  <div class="jump-to-original-rfc-container">
    <a href="https://datatracker.ietf.org/doc/html/rfc7705">
      <button type="button" class="btn btn-light btn-sm">
        <span class="jump-to-original-rfc">Orig</span>
      </button>
    </a>
  </div>
  <div class="container">
    <div>
      <div class="alert alert-info" role="alert">
        <h4 class="alert-heading">RFC 7705 - Autonomous System Migration Mechanisms and Their Effects on the BGP AS_PATH Attribute 中文翻译</h4>
        <span class="URL">原文URL :
          <a href="https://datatracker.ietf.org/doc/html/rfc7705">
            https://datatracker.ietf.org/doc/html/rfc7705
          </a>
        </span><br>
        <span class="title_zh">
          文档标题 : <strong>RFC 7705 - 自治系统迁移机制及其对 BGP AS_PATH 属性的影响</strong></span><br>
        <span class="updated_by">翻译方式 : 自动生成</span><span id="rfc_status"></span><span id="rfc_wg"></span><br>
      </div>
      <div id="rfc_alert" class="hidden" role="alert">
        <div class="alert alert-danger">
          <span id="rfc_alert_obsoleted_by"></span>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
Internet Engineering Task Force (IETF)                         W. George
Request for Comments: 7705                             Time Warner Cable
Updates: 4271                                                  S. Amante
Category: Standards Track                                    Apple, Inc.
ISSN: 2070-1721                                            November 2015
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-13">
 Autonomous System Migration Mechanisms and Their Effects on the BGP AS_PATH Attribute
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-13">
自治系统迁移机制及其对 BGP AS_PATH 属性的影响
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
Abstract
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
摘要
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This document discusses some existing commonly used BGP mechanisms for Autonomous System Number (ASN) migration that are not formally part of the BGP4 protocol specification. It is necessary to document these de facto standards to ensure that they are properly supported in future BGP protocol work.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
本文档讨论了一些现有的常用 BGP 自治系统编号 (ASN) 迁移机制，这些机制并非 BGP4 协议规范的正式组成部分。有必要记录这些事实上的标准，以确保它们在未来的 BGP 协议工作中得到适当的支持。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
Status of This Memo
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
本备忘录的地位
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This is an Internet Standards Track document.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
这是一份互联网标准跟踪文件。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This document is a product of the Internet Engineering Task Force (IETF). It represents the consensus of the IETF community. It has received public review and has been approved for publication by the Internet Engineering Steering Group (IESG). Further information on Internet Standards is available in Section 2 of RFC 5741.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
本文件是互联网工程任务组 (IETF) 的成果。它代表了 IETF 社区的共识。它已接受公众审查，并经互联网工程指导小组 (IESG) 批准发布。有关互联网标准的更多信息，请参见 RFC 5741 第 2 节。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Information about the current status of this document, any errata, and how to provide feedback on it may be obtained at http://www.rfc-editor.org/info/rfc7705.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
有关本文件的当前状态、任何勘误以及如何提供反馈的信息，请访问 http://www.rfc-editor.org/info/rfc7705。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
Copyright Notice
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
版权声明
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Copyright (c) 2015 IETF Trust and the persons identified as the document authors. All rights reserved.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
版权所有 (c) 2015 IETF 信托基金会和文件作者。保留所有权利。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This document is subject to BCP 78 and the IETF Trust&#39;s Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
本文档受 BCP 78 和本文档发布之日有效的 IETF 信托基金《与 IETF 文档有关的法律规定》 (http://trustee.ietf.org/license-info) 的约束。请仔细阅读这些文件，因为它们描述了您对本文档的权利和限制。从本文档中提取的代码组件必须包含信托法律条款第 4.e 节中所述的简化 BSD 许可文本，并且不提供简化 BSD 许可中所述的担保。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
Table of Contents
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
目录
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace toc">
   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Requirements Language . . . . . . . . . . . . . . . . . .   3
     1.2.  Documentation Note  . . . . . . . . . . . . . . . . . . .   3
   2.  ASN Migration Scenario Overview . . . . . . . . . . . . . . .   3
   3.  External BGP Autonomous System Migration Mechanisms . . . . .   5
     3.1.  Modify Inbound BGP AS_PATH Attribute  . . . . . . . . . .   5
     3.2.  Modify Outbound BGP AS_PATH Attribute . . . . . . . . . .   7
     3.3.  Implementation  . . . . . . . . . . . . . . . . . . . . .   8
   4.  Internal BGP Autonomous System Migration Mechanisms . . . . .   9
     4.1.  Internal BGP AS Migration . . . . . . . . . . . . . . . .  10
     4.2.  Implementation  . . . . . . . . . . . . . . . . . . . . .  12
   5.  Additional Operational Considerations . . . . . . . . . . . .  13
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .  14
   7.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  14
     7.1.  Normative References  . . . . . . . . . . . . . . . . . .  14
     7.2.  Informative References  . . . . . . . . . . . . . . . . .  14
   Appendix A.  Implementation Report  . . . . . . . . . . . . . . .  16
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  16
   Authors&#39; Addresses  . . . . . . . . . . . . . . . . . . . . . . .  16
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="1--Introduction">
1. Introduction
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
1. 导言
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This document discusses some existing commonly used BGP mechanisms for Autonomous System Number (ASN) migration that are not formally part of the BGP4 [RFC4271] protocol specification. These mechanisms are local to a given BGP speaker and do not require negotiation with or cooperation of BGP neighbors. The deployment of these mechanisms do not need to interwork with one another to accomplish the desired results, so slight variations between existing vendor implementations exist and will not necessarily be harmonized due to this document. However, it is necessary to document these de facto standards to ensure that new implementations can be successful, and any future protocol enhancements to BGP that propose to read, copy, manipulate, or compare the AS_PATH attribute can do so without inhibiting the use of these very widely used ASN migration mechanisms.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
本文档讨论了一些用于自治系统号码（ASN）迁移的现有常用 BGP 机制，这些机制并非 BGP4 [RFC4271] 协议规范的正式组成部分。这些机制是特定 BGP 发言者的本地机制，不需要与 BGP 邻居协商或合作。这些机制的部署不需要相互协作就能达到预期效果，因此现有供应商的实现之间存在细微差别，不一定会因为本文档而协调统一。不过，有必要将这些事实标准记录在案，以确保新的实施能够取得成功，并确保未来对 BGP 协议的任何增强（如建议读取、复制、操作或比较 AS_PATH 属性）能够在不妨碍使用这些广泛使用的 ASN 迁移机制的情况下进行。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The migration mechanisms discussed here are useful to ISPs and organizations of all sizes, but it is important to understand the business need for these mechanisms and illustrate why they are so critical for ISPs&#39; operations. During a merger, acquisition, or divestiture involving two organizations it is necessary to seamlessly migrate both internal and external BGP speakers from one ASN to a second ASN. The overall goal in doing so is to simplify operations through consistent configurations across all BGP speakers in the combined network. In addition, given that the BGP Path Selection algorithm selects routes with the shortest AS_PATH attribute, it is critical that the ISP does not increase AS_PATH length during or after ASN migration, because an increased AS_PATH length would likely result in sudden, undesirable changes in traffic-patterns in the network.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
本文讨论的迁移机制对各种规模的互联网服务提供商和组织都很有用，但重要的是要了解这些机制的业务需求，并说明为什么它们对互联网服务提供商的运营如此重要。在涉及两个组织的合并、收购或剥离过程中，有必要将内部和外部 BGP 发言者从一个 ASN 无缝迁移到第二个 ASN。这样做的总体目标是通过对合并网络中的所有 BGP 发言者进行一致的配置来简化操作。此外，鉴于 BGP 路径选择算法会选择具有最短 AS_PATH 属性的路由，因此 ISP 在 ASN 迁移期间或之后不得增加 AS_PATH 长度，这一点至关重要，因为 AS_PATH 长度的增加很可能会导致网络流量模式发生突然的、不希望发生的变化。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
By default, the BGP protocol requires an operator to configure a router to use a single remote ASN for the BGP neighbor, and the ASN must match on both ends of the peering in order to successfully negotiate and establish a BGP session. Prior to the existence of these migration mechanisms, it would have required an ISP to coordinate an ASN change with, in some cases, tens of thousands of customers. In particular, as each router is migrated to the new ASN, to avoid an outage due to ASN mismatch, the ISP would have to force all customers on that router to change their router configurations to use the new ASN immediately after the ASN change. Thus, it was critical to define a more asymmetric migration method so that the ISP could seamlessly change the ASN within its network(s) but allow the customers to gradually migrate to the ISP&#39;s new ASN when convenient. These customer migrations could occur either by coordinating individual session reconfigurations or, to allow for truly asymmetric migration, by accepting sessions using either the old or new ASN.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
默认情况下，BGP 协议要求运营商将路由器配置为使用单个远程 ASN 作为 BGP 邻居，并且 ASN 必须在对等互联的两端匹配，才能成功协商并建立 BGP 会话。在有这些迁移机制之前，互联网服务提供商需要与数以万计的客户协调 ASN 更改。特别是，当每个路由器迁移到新的 ASN 时，为避免因 ASN 不匹配而造成中断，ISP 必须在 ASN 更改后立即强制该路由器上的所有客户更改路由器配置，以使用新的 ASN。因此，必须定义一种更加非对称的迁移方法，以便互联网服务供应商可以在其网络内无缝更改 ASN，但允许客户在方便时逐步迁移到互联网服务供应商的新 ASN。这些客户迁移可以通过协调单个会话重新配置来实现，或者通过接受使用新旧 ASN 的会话来实现真正的非对称迁移。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="1-1--Requirements-Language">
1.1. Requirements Language
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
1.1. 要求语言
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The key words &#34;MUST&#34;, &#34;MUST NOT&#34;, &#34;REQUIRED&#34;, &#34;SHALL&#34;, &#34;SHALL NOT&#34;, &#34;SHOULD&#34;, &#34;SHOULD NOT&#34;, &#34;RECOMMENDED&#34;, &#34;MAY&#34;, and &#34;OPTIONAL&#34; in this document are to be interpreted as described in RFC 2119 [RFC2119].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
本文档中的关键词 &#34;MUST&#34;, &#34;MUST NOT&#34;, &#34;REQUIRED&#34;, &#34;SHALL&#34;, &#34;SHALL NOT&#34;, &#34;SHOULD&#34;, &#34;SHOULD NOT&#34;, &#34;RECOMMENDED&#34;, &#34;MAY&#34;, 以及 &#34;OPTIONAL&#34; 应按照RFC 2119 [RFC2119]中的描述进行解释。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="1-2--Documentation-Note">
1.2. Documentation Note
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
1.2. 文件说明
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This document uses Autonomous System Numbers (ASNs) from the range reserved for documentation as described in RFC 5398 [RFC5398]. In the examples used here, they are intended to represent Globally Unique ASNs, not private use ASNs as documented in Section 5 of RFC 6996 [RFC6996].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
本文档使用 RFC 5398 [RFC5398] 中所述为文档保留范围内的自治系统号 (ASN)。在这里使用的示例中，它们旨在表示全球唯一 ASN，而不是 RFC 6996 [RFC6996] 第 5 节中记录的私人使用 ASN。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="2--ASN-Migration-Scenario-Overview">
2. ASN Migration Scenario Overview
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
2. ASN 迁移方案概述
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The use case being discussed here is an ISP merging two or more ASNs, where eventually one ASN subsumes the other(s). In this use case, we will assume the most common case where there are two ISPs, A and B, that prior to the ASN migration use AS 64500 and 64510, respectively. AS 64500 will be the permanently retained ASN used across the consolidated set of both ISPs network equipment, and AS 64510 will be retired. Thus, at the conclusion of the ASN migration, there will be a single ISP A&#39; with all internal BGP speakers configured to use AS 64500. To all external BGP speakers, the AS_PATH length will not be increased.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
这里讨论的用例是 ISP 合并两个或多个 ASN，最终一个 ASN 取代另一个 ASN。在本用例中，我们将假设最常见的情况，即有两个 ISP（A 和 B），在 ASN 迁移前分别使用 AS 64500 和 64510。AS 64500 将是永久保留的 ASN，在两个互联网服务提供商的网络设备合并集中使用，而 AS 64510 将被淘汰。因此，在 ASN 迁移结束时，将只有一个 ISP A&#39;，其所有内部 BGP 扬声器都配置为使用 AS 64500。对于所有外部 BGP 发言者，AS_PATH 长度将不会增加。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
In this same scenario, AS 64496 and AS 64499 represent two separate customer networks: C and D, respectively. Originally, customer C (AS 64496) is attached to ISP B, which will undergo ASN migration from AS 64510 to AS 64500. Furthermore, customer D (AS 64499) is attached to ISP A, which does not undergo ASN migration since the ASN for ISP A will remain constant, (AS 64500). Although this example refers to AS 64496 and 64499 as customer networks, either or both may be settlement-free or other types of peers. In this use case, they are referred to as &#34;customers&#34; merely for convenience.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
在同一场景中，AS 64496 和 AS 64499 代表两个独立的客户网络：分别是 C 和 D。最初，客户 C（AS 64496）连接到 ISP B，ISP B 将从 AS 64510 向 AS 64500 迁移 ASN。此外，客户 D（AS 64499）连接到 ISP A，由于 ISP A 的 ASN 将保持不变（AS 64500），因此不会进行 ASN 迁移。虽然本例中将 AS 64496 和 64499 称作客户网络，但其中一个或两个可能是无结算网络或其他类型的对等网络。在本使用案例中，将它们称为 &#34;客户 &#34;只是为了方便。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
         ------                  ------
       / ISP  A \              / ISP  B \
      | AS 64500 |            | AS 64510 |
       \        /              \        /
        -------                 -------
           |                       |
           |                       |
     ------------             -------------
     |  Cust D  |             |  Cust C   |
     | AS 64499 |             | AS 64496  |
     ------------             -------------
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-24">
Figure 1: Before Migration
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-24">
图 1：迁移前
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
                ---------------
              /                \
             |     ISP A&#39;       |
             |     AS 64500     |
              \                /
                ---------------
             /                  \
           /                      \
          |                         |
     ------------             -------------
     |  Cust D  |             |  Cust C   |
     | AS 64499 |             | AS 64496  |
     ------------             -------------
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-25">
Figure 2: After Migration
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-25">
图 2：迁移后
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The general order of operations, typically carried out in a single maintenance window by the network undergoing ASN migration (ISP B), is as follows. First, ISP B will change the global BGP ASN used by a Provider Edge (PE) router, from ASN 64510 to 64500. At this point, the router will no longer be able to establish External BGP (eBGP) sessions toward the existing Customer Edge (CE) devices that are attached to it and still using AS 64510. Second, since ISP B needs to do this without coordinating the simultaneous change of its ASN with all of its eBGP peers, ISP B will configure two separate, but related ASN migration mechanisms discussed in this document on all eBGP sessions toward all CE devices. These mechanisms enable the router to establish BGP neighbors using the legacy ASN, modify the AS_PATH attribute received from a CE device when advertising it further, and modify AS_PATH when transmitted toward CE devices to achieve the desired effect of not increasing the length of the AS_PATH.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
进行 ASN 迁移的网络（ISP B）通常在一个维护窗口中执行的一般操作顺序如下。首先，ISP B 将把提供商边缘 (PE) 路由器使用的全局 BGP ASN 从 ASN 64510 改为 64500。此时，路由器将无法再向连接到它并仍在使用 AS 64510 的现有客户边缘 (CE) 设备建立外部 BGP (eBGP) 会话。其次，由于 ISP B 需要在不与所有 eBGP 对等方协调的情况下同时更改其 ASN，因此 ISP B 将在面向所有 CE 设备的所有 eBGP 会话上配置本文讨论的两个独立但相关的 ASN 迁移机制。这些机制使路由器能够使用传统 ASN 建立 BGP 邻居，在进一步发布广告时修改从 CE 设备收到的 AS_PATH 属性，并在向 CE 设备传输时修改 AS_PATH，以达到不增加 AS_PATH 长度的预期效果。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
At the conclusion of the ASN migration, the CE devices at the edge of the network are not aware of the fact that their upstream router is now in a new ASN and do not observe any change in the length of the AS_PATH attribute. However, after the changes discussed in this document are put in place by ISP A&#39;, there is a change to the contents of the AS_PATH attribute to ensure the AS_PATH is not artificially lengthened while these AS migration parameters are used.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
在 ASN 迁移结束时，网络边缘的 CE 设备不会意识到其上游路由器现在处于新的 ASN 中，也不会观察到 AS_PATH 属性长度的任何变化。不过，在 ISP A&#39; 实施本文讨论的变更后，AS_PATH 属性的内容会发生变化，以确保在使用这些 AS 迁移参数时，AS_PATH 不会被人为拉长。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
In this use case, neither ISP is using BGP Confederations [RFC5065] internally.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
在这种情况下，两个 ISP 内部都不使用 BGP Confederations [RFC5065]。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="3--External-BGP-Autonomous-System-Migration-Mechanisms">
3. External BGP Autonomous System Migration Mechanisms
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3. 外部 BGP 自治系统迁移机制
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The following section addresses optional capabilities that are specific to modifying the AS_PATH attribute at the Autonomous System Border Routers (ASBRs) of an organization (typically a single Service Provider). This ensures that external BGP customers/peers are not forced to make any configuration changes on their CE routers before or during the exact time the Service Provider wishes to migrate to a new, permanently retained ASN. Furthermore, these mechanisms eliminate the artificial lengthening of the AS_PATH both transmitted from and received by the Service Provider that is undergoing AS Migration, which would have negative implications on path selection by external networks.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
下一节将讨论在组织（通常是单个服务提供商）的自治系统边界路由器（ASBR）上修改 AS_PATH 属性的可选功能。这可确保在服务提供商希望迁移到新的、永久保留的 ASN 之前或期间，外部 BGP 客户/同行不会被迫在其 CE 路由器上进行任何配置更改。此外，这些机制消除了从正在进行 AS 迁移的服务提供商传输和由其接收的 AS_PATH 的人为延长，这将对外部网络的路径选择产生负面影响。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="3-1--Modify-Inbound-BGP-ASPATH-Attribute">
3.1. Modify Inbound BGP AS_PATH Attribute
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.1. 修改入站 BGP AS_PATH 属性
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The first instrument used in the process described above is called &#34;Local AS&#34;. This allows the router to supersede the globally configured ASN in the &#34;My Autonomous System&#34; field of the BGP OPEN [RFC4271] with a locally defined AS value for a specific BGP neighbor or group of neighbors. This mechanism allows the PE router that was formerly in ISP B to establish an eBGP session toward the existing CE devices using the legacy AS -- AS 64510. Ultimately, the CE devices (i.e., customer C) are completely unaware that ISP B has reconfigured its router to participate as a member of a new AS. Within the context of the former ISP B PE router, the second effect this specific mechanism has on AS_PATH is that, by default, it prepends all received BGP UPDATEs with the legacy AS of ISP B -- AS 64510 -- while advertising it (Adj-RIB-Out) to other BGP speakers (A&#39;). Within the Loc-RIB on ISP B prior to the migration, the AS_PATH of route announcements received from customer C would appear as 64496, whereas the same RIB on ISP A&#39; (ISP B routers post-migration) would contain AS_PATH 64510 64496.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
上述过程中使用的第一个工具称为 &#34;本地 AS&#34;。它允许路由器使用本地定义的 AS 值取代 BGP OPEN [RFC4271] 中 &#34;我的自治系统 &#34;字段中为特定 BGP 邻居或邻居组全局配置的 ASN。这种机制允许以前在 ISP B 中的 PE 路由器使用传统 AS AS 64510 向现有 CE 设备建立 eBGP 会话。最终，CE 设备（即客户 C）完全不知道 ISP B 已将其路由器重新配置为新 AS 的成员。在前 ISP B PE 路由器的范围内，这一特定机制对 AS_PATH 的第二个影响是，默认情况下，它会在所有接收到的 BGP UPDATE 前加上 ISP B 的传统 AS -- AS 64510，同时向其他 BGP 发言者（A&#39;）发布广告（Adj-RIB-Out）。在迁移前 ISP B 的 Loc-RIB 中，从客户 C 收到的路由通告的 AS_PATH 将显示为 64496，而 ISP A&#39;（迁移后的 ISP B 路由器）的相同 RIB 将包含 AS_PATH 64510 64496。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The second instrument, referred to as &#34;No Prepend Inbound&#34;, is enabled on PE routers migrating from ISP B. The &#34;No Prepend Inbound&#34; capability causes ISP B&#39;s routers to not prepend the legacy AS (AS 64510), when advertising UPDATES received from customer C. This restores the AS_PATH within ISP A&#39; for route announcements received from customer C so that it is just one ASN in length: 64496.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
第二个工具被称为 &#34;No Prepend Inbound&#34;，在从 ISP B 迁移的 PE 路由器上启用。&#34;No Prepend Inbound &#34;功能会导致 ISP B 的路由器在发布从客户 C 收到的 UPDATES 时不预置传统 AS（AS 64510）。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
In the direction of CE -&gt; PE (inbound):
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
在 CE -&gt; PE（入站）方向上：
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
1. &#34;Local AS&#34;: Allows the local BGP router to generate a BGP OPEN to an eBGP neighbor with the old, legacy ASN value in the &#34;My Autonomous System&#34; field. When this capability is activated, it also causes the local router to prepend the &lt;old_ASN&gt; value to the AS_PATH when installing or advertising routes received from a CE to Internal BGP (iBGP) neighbors inside the Autonomous System.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
1. &#34;本地 AS&#34;：允许本地 BGP 路由器在 &#34;我的自治系统 &#34;字段中使用旧的传统 ASN 值，向 eBGP 邻居生成 BGP OPEN。激活此功能后，本地路由器在将从 CE 接收到的路由安装或发布到自治系统内部的内部 BGP (iBGP) 邻居时，也会将 &lt;old_ASN&gt; 值预置到 AS_PATH。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
2. &#34;No Prepend Inbound (of Local AS)&#34;: The local BGP router does not prepend the &lt;old_ASN&gt; value to the AS_PATH when installing or advertising routes received from the CE to iBGP neighbors inside the Autonomous System
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
2. &#34;无预输入（本地 AS）&#34;：安装或向自治系统内的 iBGP 邻居通告从 CE 接收到的路由时，本地 BGP 路由器不会将 &lt;old_ASN&gt; 值预输入 AS_PATH。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
PE-B is a PE that was originally in ISP B, and has a customer eBGP session to CE-B. PE-B has had its global configuration ASN changed from AS 64510 to AS 64500 to make it part of the permanently retained ASN. This now makes PE-B a member of ISP A&#39;. PE-A is a PE that was originally in ISP A, and has a customer peer CE-A. Although its global configuration ASN remains AS 64500, throughout this exercise we also consider PE-A a member of ISP A&#39;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
PE-B 是原来属于 ISP B 的一个 PE，与 CE-B 有一个客户 eBGP 会话。PE-B 的全局配置 ASN 已从 AS 64510 更改为 AS 64500，使其成为永久保留 ASN 的一部分。这使得 PE-B 成为 ISP A&#39; 的成员。PE-A 是原来属于 ISP A 的一个 PE，有一个客户对等 CE-A。虽然其全局配置 ASN 仍为 AS 64500，但在整个练习中，我们也将 PE-A 视为 ISP A&#39; 的成员。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
                    ISP A&#39;                    ISP A&#39;
              CE-A &lt;--- PE-A &lt;------------------- PE-B &lt;--- CE-B
              64499     New_ASN: 64500   Old_ASN: 64510     64496
                                         New_ASN: 64500
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-13">
Note: Direction of BGP UPDATE as per the arrows.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-13">
注：BGP UPDATE 的方向与箭头所示一致。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-11">
Figure 3: Local AS and No Prepend BGP UPDATE Diagram
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-11">
图 3：本地 AS 和无预置 BGP UPDATE 图
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
As a result, using both the &#34;Local AS&#34; and &#34;No Prepend Inbound&#34; capabilities on PE-B, CE-A will see an AS_PATH of 64500 64496. CE-A will not receive a BGP UPDATE containing AS 64510 in the AS_PATH. (If only the &#34;Local AS&#34; mechanism was configured without &#34;No Prepend Inbound&#34; on PE-B, then CE-A would have seen an AS_PATH of 64500 64510 64496, which results in an unacceptable lengthening of the AS_PATH). Note: If there are still routers in the old ASN (64510), it is possible for them to accept these manipulated routes (i.e., those with 64510 removed from the AS_PATH by this command) as if they have not already passed through their ASN, potentially causing a loop, since BGP&#39;s normal loop-prevention behavior of rejecting routes that include its ASN in the path will not catch these. Careful filtering between routers remaining in the old ASN and routers migrated to the new ASN is necessary to minimize the risk of routing loops.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
因此，在 PE-B 上同时使用 &#34;本地 AS &#34;和 &#34;无预置入站 &#34;功能时，CE-A 将看到 AS_PATH 为 64500 64496。CE-A 将不会收到 AS_PATH 中包含 AS 64510 的 BGP UPDATE。(如果只配置了 &#34;本地 AS &#34;机制，而没有在 PE-B 上配置 &#34;No Prepend Inbound&#34;（无预输入）功能，那么 CE-A 将看到 AS_PATH 为 64500 64510 64496，这将导致 AS_PATH 不可接受地延长）。注意：如果旧 ASN (64510) 中仍有路由器，它们就有可能接受这些经过处理的路由（即通过此命令从 AS_PATH 中删除了 64510 的路由），就好像这些路由尚未通过它们的 ASN，从而可能导致环路，因为 BGP 拒绝路径中包含其 ASN 的路由的正常环路预防行为不会捕获这些路由。为了尽量减少路由环路的风险，有必要在保留在旧 ASN 中的路由器和迁移到新 ASN 的路由器之间进行仔细过滤。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="3-2--Modify-Outbound-BGP-ASPATH-Attribute">
3.2. Modify Outbound BGP AS_PATH Attribute
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.2. 修改出站 BGP AS_PATH 属性
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The two aforementioned mechanisms, &#34;Local AS&#34; and &#34;No Prepend Inbound&#34;, only modify the AS_PATH attribute received by the ISP&#39;s PEs in the course of processing BGP UPDATEs from CE devices when CE devices still have an eBGP session established with the ISPs legacy AS (AS64510).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
上述两种机制，即 &#34;本地 AS &#34;和 &#34;无预置入站&#34;，只在 CE 设备仍与 ISP 的传统 AS（AS64510）建立了 eBGP 会话时，ISP 的 PE 在处理来自 CE 设备的 BGP UPDATE 过程中修改其接收的 AS_PATH 属性。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
In some existing implementations, &#34;Local AS&#34; and &#34;No Prepend Inbound&#34; do not concurrently modify the AS_PATH attribute for BGP UPDATEs that are transmitted by the ISP&#39;s PEs to CE devices. In these implementations, with &#34;Local AS&#34; and &#34;No Prepend Inbound&#34; used on PE-B, there is an automatic lengthening of the AS_PATH in outbound BGP UPDATEs from ISP A&#39; toward directly attached eBGP speakers (customer C in AS 64496). The externally observed result is that customer C in AS 64496 will receive the following AS_PATH: 64510 64500 64499. Therefore, if ISP A&#39; takes no further action, there will be an unacceptable increase in the AS_PATH length within the customer&#39;s networks directly attached to ISP A&#39;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
在某些现有实现中，&#34;Local AS &#34;和 &#34;No Prepend Inbound &#34;不会同时修改由 ISP 的 PE 发送到 CE 设备的 BGP UPDATE 的 AS_PATH 属性。在这些实施中，PE-B 使用 &#34;本地 AS &#34;和 &#34;无预编入站 &#34;时，ISP A 向直接连接的 eBGP 发言者（AS 64496 中的客户 C）发出的 BGP UPDATE 中的 AS_PATH 会自动加长。外部观察到的结果是，AS 64496 中的客户 C 将收到以下 AS_PATH：64510 64500 64499。因此，如果 ISP A&#39;不采取进一步措施，直接连接到 ISP A&#39;的客户网络内的 AS_PATH 长度将增加到不可接受的程度。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
A tertiary mechanism, referred to as &#34;Replace Old AS&#34;, is used to resolve this problem. This capability allows ISP A&#39; to prevent routers from appending the globally configured ASN in outbound BGP UPDATEs toward directly attached eBGP neighbors that are using the &#34;Local AS&#34; mechanism. Instead, only the old (or previously used) AS will be prepended in the outbound BGP UPDATE toward the customer&#39;s network, restoring the AS_PATH length to what it what was before AS Migration occurred.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
称为 &#34;替换旧 AS &#34;的第三机制可用于解决这一问题。ISP A&#39;可利用这一功能防止路由器在向使用 &#34;本地 AS &#34;机制的直接连接 eBGP 邻居发出的 BGP UPDATE 中附加全局配置的 ASN。取而代之的是，在向客户网络发出的 BGP UPDATE 中，只附加旧的（或以前使用过的）AS，将 AS_PATH 长度恢复到 AS 迁移发生前的长度。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
To reuse the above diagram, but in the opposite direction, we have:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
重新使用上图，但方向相反，我们可以得出
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
                         ISP A&#39;                    ISP A&#39;
              CE-A ---&gt; PE-A -------------------&gt; PE-B ---&gt; CE-B
              64499     New_ASN: 64500   Old_ASN: 64510     64496
                                         New_ASN: 64500
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-13">
Note: Direction of BGP UPDATE as per the arrows.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-13">
注：BGP UPDATE 的方向与箭头所示一致。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-18">
Figure 4: Replace AS BGP UPDATE Diagram
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-18">
图 4：替换 AS BGP UPDATE 图表
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
By default, without the use of &#34;Replace Old AS&#34;, CE-B would see an AS_PATH of 64510 64500 64499. After ISP A&#39; changes PE-B to use &#34;Replace Old AS&#34;, CE-B would receive an AS_PATH of 64510 64499, which is the same AS_PATH length pre-AS migration.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
默认情况下，如果不使用 &#34;替换旧 AS&#34;，CE-B 将看到一个 AS_PATH 为 64510 64500 64499 的 AS_PATH。ISP A&#39;将 PE-B 改为使用 &#34;替换旧 AS &#34;后，CE-B 将收到 64510 64499 的 AS_PATH，这与 AS 迁移前的 AS_PATH 长度相同。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="3-3--Implementation">
3.3. Implementation
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
3.3. 实施情况
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The mechanisms introduced in this section MUST be configurable on a per-neighbor or per-neighbor-group basis to allow for maximum flexibility. (Here, &#34;neighbor group&#34; refers to a group of similar BGP neighbor statements that reuse some common configuration to simplify provisioning.) When the &#34;Local AS&#34; capability is used, a local ASN will be provided in the configuration that is different from the globally configured ASN of the BGP router. To implement this mechanism, a BGP speaker SHOULD send BGP OPEN [RFC4271] (see Section 4.2) messages to the configured eBGP peer(s) using the local ASN configured for this session as the value sent in &#34;My Autonomous System&#34;. The BGP router SHOULD NOT use the ASN configured globally within the BGP process as the value sent in &#34;My Autonomous System&#34; in the OPEN message. This prevents causing the eBGP neighbor to unnecessarily generate a BGP OPEN Error message &#34;Bad Peer AS&#34;. This method is typically used to re-establish eBGP sessions with peers expecting the legacy ASN after a router has been moved to a new ASN.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
本节介绍的机制必须可按每个邻居或每个邻居组进行配置，以实现最大的灵活性。(这里的 &#34;邻居组 &#34;指的是一组类似的 BGP 邻居声明，它们重复使用某些共同配置以简化配置）。使用 &#34;本地 AS &#34;功能时，配置中将提供一个本地 ASN，该 ASN 与 BGP 路由器的全局配置 ASN 不同。为实施此机制，BGP 说话者应使用为此会话配置的本地 ASN 作为 &#34;我的自治系统 &#34;中的发送值，向已配置的 eBGP 对等发送 BGP OPEN [RFC4271]（见第 4.2 节）消息。BGP 路由器不应使用在 BGP 进程中全局配置的 ASN 作为 OPEN 消息中 &#34;我的自治系统 &#34;的发送值。这可避免导致 eBGP 邻居不必要地生成 BGP OPEN 错误消息 &#34;Bad Peer AS&#34;。这种方法通常用于在路由器迁移到新的 ASN 后，与期望使用传统 ASN 的对等方重新建立 eBGP 会话。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Implementations MAY support a more flexible model where the eBGP speaker attempts to open the BGP session using either the ASN configured as &#34;Local AS&#34; or the globally configured AS as discussed in BGP Alias (Section 4.2). If the session is successfully established to the globally configured ASN, then the modifications to AS_PATH described in this document SHOULD NOT be performed, as they are unnecessary. The benefit to this more flexible model is that it allows the remote neighbor to reconfigure to the new ASN without direct coordination between the ISP and the customer.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
实施可以支持一种更灵活的模式，即 eBGP 说话者尝试使用配置为 &#34;本地 AS &#34;的 ASN 或 BGP 别名（第 4.2 节）中讨论的全局配置 AS 打开 BGP 会话。如果会话成功建立到全局配置的 ASN，则不应执行本文档中描述的对 AS_PATH 的修改，因为这些修改是不必要的。这种更灵活模式的好处是，它允许远程邻居重新配置到新的 ASN，而无需 ISP 和客户之间直接协调。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Note that this procedure will vary slightly if the locally or globally configured ASN is a 4-octet ASN. See Section 3 of [RFC6793].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
请注意，如果本地或全局配置的 ASN 是 4 八位字节 ASN，则此步骤会略有不同。参见 [RFC6793] 第 3 节。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
When the BGP router receives UPDATEs from its eBGP neighbor configured with the &#34;Local AS&#34; mechanism, it processes the UPDATE as described in RFC4271 Section 5.1.2 [RFC4271]. However, the presence of a second ASN due to &#34;Local AS&#34; adds the following behavior to processing UPDATEs received from an eBGP neighbor configured with this mechanism:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
当 BGP 路由器从配置了 &#34;本地 AS &#34;机制的 eBGP 邻居处接收 UPDATE 时，它会按照 RFC4271 第 5.1.2 节 [RFC4271] 中的描述处理 UPDATE。但是，由于 &#34;本地 AS &#34;存在第二个 ASN，因此在处理从配置了该机制的 eBGP 邻居处收到的 UPDATE 时，会增加以下行为：
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
1. Internal: The router SHOULD append the configured &#34;Local AS&#34; ASN in the AS_PATH attribute before installing the route or advertising the UPDATE to an iBGP neighbor. The decision of when to append the ASN is an implementation detail outside the scope of this document. Some considerations factoring into this decision include consistency in the AS_PATH throughout the AS, and implementation of the loop detection mechanism.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
1. 内部：在安装路由或向 iBGP 邻居发布 UPDATE 之前，路由器应在 AS_PATH 属性中附加已配置的 &#34;本地 AS &#34;ASN。何时附加 ASN 的决定是本文档范围之外的实施细节。做出这一决定的一些考虑因素包括整个 AS 中 AS_PATH 的一致性，以及循环检测机制的实施。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
2. External: The BGP router SHOULD first append the globally configured ASN to the AS_PATH immediately followed by the &#34;Local AS&#34; value before advertising the UPDATE to an eBGP neighbor.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
2. 外部：在向 eBGP 邻居发布 UPDATE 之前，BGP 路由器应首先将全局配置的 ASN 附加到 AS_PATH，紧接着是 &#34;本地 AS &#34;值。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Two options exist to manipulate the behavior of the basic &#34;Local AS&#34; mechanism. They modify the behavior as described below:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
有两个选项可操作基本 &#34;本地 AS &#34;机制的行为。它们对行为的修改如下所述：
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
1. &#34;No Prepend Inbound&#34;: When the BGP router receives inbound BGP UPDATEs from its eBGP neighbor configured with this option, it MUST NOT append the &#34;Local AS&#34; ASN value in the AS_PATH attribute when installing the route or advertising that UPDATE to iBGP neighbors, but it MUST still append the globally configured ASN as normal when advertising the UPDATE to other local eBGP neighbors (i.e., those natively peering with the globally configured ASN).
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
1. &#34;不预输入&#34;（No Prepend Inbound）：当 BGP 路由器从配置了此选项的 eBGP 邻居接收入站 BGP UPDATE 时，在安装路由或向 iBGP 邻居发布 UPDATE 时，不得在 AS_PATH 属性中附加 &#34;本地 AS &#34;ASN 值，但在向其他本地 eBGP 邻居（即与全局配置的 ASN 进行本地对等互联的邻居）发布 UPDATE 时，仍必须按正常方式附加全局配置的 ASN。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
2. &#34;Replace Old AS&#34; (outbound): When the BGP router generates outbound BGP UPDATEs toward an eBGP neighbor configured with this option, the BGP speaker MUST NOT append the globally configured ASN from the AS_PATH attribute. The BGP router MUST append only the configured &#34;Local AS&#34; ASN value to the AS_PATH attribute before sending the BGP UPDATEs outbound to the eBGP neighbor.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
2. &#34;替换旧 AS&#34;（出站）：当 BGP 路由器向配置了此选项的 eBGP 邻居生成出站 BGP UPDATE 时，BGP 发言者不得附加 AS_PATH 属性中的全局配置 ASN。BGP 路由器向出站 eBGP 邻居发送 BGP UPDATE 前，必须仅将配置的 &#34;本地 AS &#34;ASN 值附加到 AS_PATH 属性。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="4--Internal-BGP-Autonomous-System-Migration-Mechanisms">
4. Internal BGP Autonomous System Migration Mechanisms
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4. 内部 BGP 自治系统迁移机制
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The following section describes mechanisms that assist with a gradual and least service-impacting migration of Internal BGP sessions from a legacy ASN to the permanently retained ASN. The following mechanism is very valuable to networks undergoing AS migration, but its use does not cause changes to the AS_PATH attribute.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
下一节介绍了一些机制，这些机制有助于将内部 BGP 会话从传统 ASN 逐步迁移到永久保留的 ASN，而且对服务的影响最小。以下机制对正在进行 AS 迁移的网络非常有价值，但其使用不会导致 AS_PATH 属性发生变化。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="4-1--Internal-BGP-AS-Migration">
4.1. Internal BGP AS Migration
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.1. 内部 BGP AS 迁移
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
In this case, all of the routers to be consolidated into a single, permanently retained ASN are under the administrative control of a single entity. Unfortunately, the traditional method of migrating all Internal BGP speakers, particularly within larger networks, is both time-consuming and widely service impacting.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
在这种情况下，所有要合并到一个永久保留的 ASN 中的路由器都在一个实体的管理控制之下。遗憾的是，迁移所有内部 BGP 发言者的传统方法（尤其是在大型网络中）既耗时又会对服务产生广泛影响。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The traditional method to migrate Internal BGP sessions was strictly limited to reconfiguration of the global configuration ASN and, concurrently, changing all iBGP neighbors&#39; remote ASN from the legacy ASN to the new, permanently retained ASN on each router within the legacy AS. These changes can be challenging to swiftly execute in networks with more than a few dozen internal BGP routers. There are also the concomitant service interruptions as these changes are made to routers within the network, resulting in a reset of iBGP sessions and subsequent route reconvergence to reestablish optimal routing paths. Operators often cannot make such sweeping changes given the associated risks of a highly visible service interruption; rather, they require a more gradual method to migrate Internal BGP sessions, from one ASN to a second, permanently retained ASN, that is not visibly service impacting to its customers.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
迁移内部 BGP 会话的传统方法仅限于重新配置全局配置 ASN，同时将所有 iBGP 邻居的远程 ASN 从传统 ASN 更改为传统 AS 内每个路由器上永久保留的新 ASN。在拥有几十台以上内部 BGP 路由器的网络中，要迅速执行这些更改可能很困难。此外，在对网络内的路由器进行这些更改时，还会伴随着服务中断，导致 iBGP 会话重置和随后的路由重新融合，以重新建立最佳路由路径。鉴于服务中断的相关风险非常明显，运营商通常无法做出这种大刀阔斧的改变；相反，他们需要一种更循序渐进的方法，将内部 BGP 会话从一个 ASN 迁移到第二个永久保留的 ASN，这样就不会对客户造成明显的服务影响。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
With the &#34;Internal BGP AS Migration&#34; mechanism described herein, it allows an Internal BGP speaker to form a single iBGP session using either the old, legacy ASN or the new, permanently retained ASN. The benefits of using this mechanism are several fold. First, it allows for a more gradual and less service-impacting migration away from the legacy ASN to the permanently retained ASN. Second, it (temporarily) permits the coexistence of the legacy and permanently retained ASN within a single network, allowing for uniform BGP path selection among all routers within the consolidated network.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
通过本文所述的 &#34;内部 BGP AS 迁移 &#34;机制，内部 BGP 发言者可以使用旧的传统 ASN 或新的永久保留 ASN 形成单个 iBGP 会话。使用这种机制有几个好处。首先，它允许从传统 ASN 逐步迁移到永久保留的 ASN，对服务的影响较小。其次，它（暂时）允许传统 ASN 和永久保留的 ASN 在单个网络内共存，允许在合并网络内的所有路由器之间进行统一的 BGP 路径选择。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The iBGP router with the &#34;Internal BGP AS Migration&#34; capability enabled allows the receipt of a BGP OPEN message with either the legacy ASN value or the new, globally configured ASN value in the &#34;My Autonomous System&#34; field of the BGP OPEN message from iBGP neighbors. It is important to recognize that enablement of the &#34;Internal BGP AS Migration&#34; mechanism preserves the semantics of a regular iBGP session (i.e., using identical ASNs). Thus, the BGP attributes transmitted by and the acceptable methods of operation on BGP attributes received from iBGP sessions configured with &#34;Internal BGP AS Migration&#34; capability are no different than those exchanged across an iBGP session without &#34;Internal BGP AS Migration&#34; configured, as defined by [RFC4271] and [RFC4456].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
启用了 &#34;内部 BGP AS 迁移 &#34;功能的 iBGP 路由器允许从 iBGP 邻居接收 BGP OPEN 消息，在该消息的 &#34;我的自治系统 &#34;字段中使用传统 ASN 值或新的全局配置 ASN 值。必须认识到，启用 &#34;内部 BGP AS 迁移 &#34;机制会保留常规 iBGP 会话的语义（即使用相同的 ASN）。因此，根据 [RFC4271] 和 [RFC4456] 的定义，从配置了 &#34;内部 BGP AS 迁移 &#34;功能的 iBGP 会话接收到的 BGP 属性所传输的 BGP 属性以及对 BGP 属性的可接受操作方法与未配置 &#34;内部 BGP AS 迁移 &#34;功能的 iBGP 会话中交换的 BGP 属性并无不同。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Typically, in medium to large networks, BGP Route Reflectors (RRs) [RFC4456] are used to aid in reduction of configuration of iBGP sessions and scalability with respect to overall TCP (and BGP) session maintenance between adjacent iBGP routers. Furthermore, BGP Route Reflectors are typically deployed in pairs within a single Route Reflection cluster to ensure high reliability of the BGP Control Plane. As such, the following example will use Route Reflectors to aid in understanding the use of the &#34;Internal BGP AS Migration&#34; mechanism. Note that Route Reflectors are not a prerequisite to enable &#34;Internal BGP AS Migration&#34; and this mechanism can be enabled independent of the use of Route Reflectors.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
通常，在大中型网络中，BGP 路由反射器 (RR) [RFC4456] 被用来帮助减少 iBGP 会话的配置，并提高相邻 iBGP 路由器之间整体 TCP（和 BGP）会话维护的可扩展性。此外，BGP 路由反射器通常成对部署在单个路由反射群集中，以确保 BGP 控制平面的高可靠性。因此，下面的示例将使用路由反射器来帮助理解 &#34;内部 BGP AS 迁移 &#34;机制的使用。请注意，路由反射器并不是启用 &#34;内部 BGP AS 迁移 &#34;的先决条件，该机制可以在不使用路由反射器的情况下启用。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The general order of operations is as follows:
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
一般操作顺序如下
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
1. Within the legacy network, (the routers comprising the set of devices that still have a globally configured legacy ASN), one member of a redundant pair of RRs has its global configuration ASN changed to the permanently retained ASN. Concurrently, the &#34;Internal BGP AS Migration&#34; capability is enabled on all iBGP sessions on that device. This will comprise Non-Client iBGP sessions to other RRs as well as Client iBGP sessions, typically to PE devices, both still utilizing the legacy ASN. Note that during this step there will be a reset and reconvergence event on all iBGP sessions on the RRs whose configuration was modified; however, this should not be service impacting due to the use of redundant RRs in each RR Cluster.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
1. 在传统网络（由一组仍具有全局配置的传统 ASN 的设备组成的路由器）中，一对冗余 RR 中的一个成员的全局配置 ASN 已更改为永久保留的 ASN。同时，在该设备上的所有 iBGP 会话上启用 &#34;内部 BGP AS 迁移 &#34;功能。这将包括到其他 RR 的非客户 iBGP 会话以及客户 iBGP 会话，通常是到 PE 设备的会话，两者都仍在使用传统 ASN。请注意，在此步骤中，配置被修改的 RR 上的所有 iBGP 会话都将发生重置和重新融合事件；不过，由于每个 RR 集群中都使用了冗余 RR，这应该不会影响服务。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
2. The above step is repeated for the other side of the redundant pair of RRs. The one alteration to the above procedure is that the &#34;Internal BGP AS Migration&#34; mechanism is now removed from the Non-Client iBGP sessions toward the other (previously reconfigured) RRs, since it is no longer needed. The &#34;Internal BGP AS Migration&#34; mechanism is still required on all RRs for all RR Client iBGP sessions. Also during this step, there will be a reset and reconvergence event on all iBGP sessions whose configuration was modified, but this should not be service impacting. At the conclusion of this step, all RRs will have their globally configured ASN set to the permanently retained ASN and &#34;Internal BGP AS Migration&#34; enabled and in use toward RR Clients.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
2. 对冗余的一对 RR 的另一侧重复上述步骤。上述步骤的一个变化是，&#34;Internal BGP AS Migration（内部 BGP AS 迁移）&#34;机制现在已从面向其他（先前重新配置的）RR 的非客户 iBGP 会话中移除，因为不再需要该机制。所有 RR 客户端 iBGP 会话的所有 RR 上仍然需要 &#34;内部 BGP AS 迁移 &#34;机制。此外，在此步骤中，配置被修改的所有 iBGP 会话都将发生重置和重新融合事件，但这不会影响服务。完成此步骤后，所有 RR 的全局配置 ASN 都将设置为永久保留的 ASN，&#34;内部 BGP AS 迁移 &#34;将启用并用于 RR 客户端。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
3. At this point, the network administrators would then be able to establish iBGP sessions between all Route Reflectors in both the legacy and permanently retained networks. This would allow the network to appear to function, both internally and externally, as a single, consolidated network using the permanently retained network.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
3. 此时，网络管理员就可以在传统网络和永久保留网络的所有路由反射器之间建立 iBGP 会话。这样，无论是对内还是对外，网络都会显示为使用永久保留网络的单一合并网络。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
4. To complete the AS migration, each RR Client (PE) in the legacy network still utilizing the legacy ASN is now modified. Specifically, each legacy PE would have its globally configured ASN changed to use the permanently retained ASN. The ASN configured within the PE for the iBGP sessions toward each RR would be changed to use the permanently retained ASN. It is unnecessary to enable the &#34;Internal BGP AS Migration&#34; mechanism on these migrated iBGP sessions. During the same maintenance window, External BGP sessions would be modified to include the above &#34;Local AS&#34;, &#34;No Prepend&#34;, and &#34;Replace Old AS&#34; mechanisms described in Section 3 above, since all of the changes are service interrupting to the eBGP sessions of the PE. At this point, all PEs will have been migrated to the permanently retained ASN.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
4. 为了完成 AS 迁移，现在要对传统网络中仍在使用传统 ASN 的每个 RR 客户端 (PE) 进行修改。具体来说，每个传统 PE 的全局配置 ASN 将被修改为使用永久保留的 ASN。没有必要在这些迁移的 iBGP 会话上启用 &#34;内部 BGP AS 迁移 &#34;机制。在同一维护窗口期间，外部 BGP 会话将被修改为包括上述第 3 节所述的 &#34;本地 AS&#34;、&#34;无预添加 &#34;和 &#34;替换旧 AS &#34;机制，因为所有这些更改都会中断 PE 的 eBGP 会话服务。此时，所有 PE 都将迁移到永久保留的 ASN。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
5. The final step is to excise the &#34;Internal BGP AS Migration&#34; configuration from the Router Reflectors in an orderly fashion. After this is complete, all routers in the network will be using the new, permanently retained ASN for all iBGP sessions with no vestiges of the legacy ASN on any iBGP sessions.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
5. 最后一步是有序地从路由器反射器中删除 &#34;内部 BGP AS 迁移 &#34;配置。这项工作完成后，网络中的所有路由器都将在所有 iBGP 会话中使用永久保留的新 ASN，而不会在任何 iBGP 会话中残留传统 ASN。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The benefit of using the aforementioned &#34;Internal BGP AS Migration&#34; capability is that it is a more gradual and less externally service impacting change to accomplish an AS migration. Previously, without &#34;Internal BGP AS Migration&#34;, such an AS migration change would carry a high risk and need to be successfully accomplished in a very short time frame (e.g., at most several hours). In addition, it would likely cause substantial routing churn and rapid fluctuations in traffic carried -- potentially causing periods of congestion and resultant packet loss -- during the period when the configuration changes are underway to complete the AS Migration. On the other hand, with &#34;Internal BGP AS Migration&#34;, the migration from the legacy ASN to the permanently retained ASN can occur over a period of days or weeks with reduced customer disruption. (The only observable service disruption should be when each PE undergoes the changes discussed in step 4 above.)
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
使用上述 &#34;内部 BGP AS 迁移 &#34;功能的好处是，在完成 AS 迁移时，变化更渐进，对外部服务的影响更小。在此之前，如果没有 &#34;内部 BGP AS 迁移&#34;，这种 AS 迁移变化将具有很高的风险，需要在很短的时间内（如最多几个小时）成功完成。此外，在为完成 AS 迁移而进行配置更改期间，很可能会造成大量路由变化和流量的快速波动，从而可能导致拥塞和数据包丢失。另一方面，通过 &#34;内部 BGP AS 迁移&#34;，从传统 ASN 迁移到永久保留的 ASN 的过程可持续数天或数周，减少客户中断。(唯一可观察到的服务中断应该是在每个 PE 进行上述第 4 步讨论的更改时）。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="4-2--Implementation">
4.2. Implementation
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
4.2. 实施情况
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
The mechanism introduced in this section MUST be configurable on a per-neighbor or per-neighbor-group basis to allow for maximum flexibility. When configured with this mechanism, a BGP speaker MUST accept BGP OPEN and establish an iBGP session from configured iBGP peers if the ASN value in &#34;My Autonomous System&#34; is either the globally configured ASN or a locally configured ASN provided when this capability is utilized. Additionally, a BGP router configured with this mechanism MUST send its own BGP OPEN [RFC4271] (see Section 4.2) using either the globally configured or the locally configured ASN in &#34;My Autonomous System&#34; as follows. To avoid potential deadlocks when two BGP speakers are attempting to establish a BGP peering session and are both configured with this mechanism, the speaker SHOULD send BGP OPEN using the globally configured ASN first, and only send a BGP OPEN using the locally configured ASN as a fallback if the remote neighbor responds with the BGP error &#34;Bad Peer AS&#34;. In each case, the BGP speaker MUST treat UPDATEs sent and received to this peer as if this was a natively configured iBGP session, as defined by [RFC4271] and [RFC4456].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
本节引入的机制必须可按每个邻居或每个邻居组进行配置，以实现最大的灵活性。配置该机制后，如果 &#34;我的自治系统&#34;（My Autonomous System）中的 ASN 值是全局配置的 ASN 或使用该功能时提供的本地配置的 ASN，则 BGP 说话者必须接受 BGP OPEN 并从配置的 iBGP 对等方建立 iBGP 会话。此外，配置了该机制的 BGP 路由器必须使用 &#34;我的自治系统 &#34;中的全局配置 ASN 或本地配置 ASN 发送自己的 BGP OPEN [RFC4271]（见第 4.2 节），具体如下。当两个 BGP 发言者都试图建立 BGP 对等会话且都配置了该机制时，为避免潜在的死锁，发言者应首先使用全局配置的 ASN 发送 BGP OPEN，只有当远程邻居响应 BGP 错误 &#34;Bad Peer AS &#34;时，才使用本地配置的 ASN 发送 BGP OPEN 作为后备。在每种情况下，BGP 说话者都必须按照 [RFC4271] 和 [RFC4456] 的定义，将发送和接收到该对等节点的 UPDATE 视为本地配置的 iBGP 会话。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Note that this procedure will vary slightly if the locally or globally configured ASN is a 4-octet ASN. See Section 3 of [RFC6793].
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
请注意，如果本地或全局配置的 ASN 是 4 八位字节 ASN，则此步骤会略有不同。参见 [RFC6793] 第 3 节。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="5--Additional-Operational-Considerations">
5. Additional Operational Considerations
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
5. 其他运行考虑因素
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This document describes several mechanisms to support ISPs and other organizations that need to perform ASN migrations. Other variations of these mechanisms may exist, for example, in legacy router software that has not been upgraded or reached End of Life, but continues to operate in the network. Such variations are beyond the scope of this document.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
本文档介绍了几种支持 ISP 和其他需要执行 ASN 迁移的机构的机制。这些机制的其他变体也可能存在，例如，在未升级或已达到报废年限但仍继续在网络中运行的传统路由器软件中。这些变化超出了本文档的范围。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Companies routinely go through periods of mergers, acquisitions, and divestitures, which in the case of the former cause them to accumulate several legacy ASNs over time. ISPs often do not have control over the configuration of customers&#39; devices (i.e., the ISPs are often not providing a managed CE router service, particularly to medium and large customers that require eBGP). Furthermore, ISPs are using methods to perform ASN migration that do not require coordination with customers. Ultimately, this means there is not a finite period of time after which legacy ASNs will be completely expunged from the ISP&#39;s network. In fact, it is common that legacy ASNs and the associated External BGP AS Migration mechanisms discussed in this document can and do persist for several years, if not longer. Thus, it is prudent to plan that legacy ASNs and associated External BGP AS Migration mechanisms will persist in an operational network indefinitely.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
公司经常会经历兼并、收购和资产剥离期，前者会导致公司长期积累多个遗留 ASN。ISP 通常无法控制客户设备的配置（即 ISP 通常不提供受管理的 CE 路由器服务，尤其是对需要 eBGP 的大中型客户）。此外，ISP 正在使用无需与客户协调的方法来执行 ASN 迁移。归根结底，这意味着并不存在一个有限的时间段，在该时间段后，传统 ASN 将完全从 ISP 的网络中删除。事实上，传统 ASN 和本文讨论的相关外部 BGP AS 迁移机制通常会持续存在数年，甚至更久。因此，为谨慎起见，应计划将传统 ASN 和相关的外部 BGP AS 迁移机制无限期地保留在运行网络中。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
With respect to the Internal BGP AS Migration mechanism, all of the routers to be consolidated into a single, permanently retained ASN are under the administrative control of a single entity. Thus, completing the migration from iBGP sessions using the legacy ASN to the permanently retained ASN is more straightforward and could be accomplished in a matter of days to months. Finally, good operational hygiene would dictate that it is good practice to avoid using &#34;Internal BGP AS Migration&#34; capability over a long period of time for reasons of not only operational simplicity of the network, but also reduced reliance on that mechanism during the ongoing life cycle management of software, features, and configurations that are maintained on the network.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
关于内部 BGP AS 迁移机制，所有要合并到一个永久保留的 ASN 的路由器都在一个实体的行政控制之下。因此，完成从使用传统 ASN 的 iBGP 会话到永久保留的 ASN 的迁移更为直接，可在几天到几个月内完成。最后，良好的操作卫生习惯要求避免长期使用 &#34;内部 BGP AS 迁移 &#34;功能，这不仅是为了简化网络操作，也是为了在对网络上维护的软件、功能和配置进行持续生命周期管理时减少对该机制的依赖。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="6--Security-Considerations">
6. Security Considerations
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
6. 安全考虑因素
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This document discusses a process by which one ASN is migrated into and subsumed by another. This involves manipulating the AS_PATH attribute with the intent of not increasing the AS_PATH length, which would typically cause the BGP route to no longer be selected by BGP&#39;s Path Selection Algorithm in others&#39; networks. This could result in sudden and unexpected shifts in traffic patterns in the network, potentially resulting in congestion.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
本文件讨论了将一个 ASN 迁移到另一个 ASN 并将其归入另一个 ASN 的过程。这涉及到对 AS_PATH 属性的操作，目的是不增加 AS_PATH 长度，这通常会导致 BGP 路由不再被他人网络中的 BGP 路径选择算法所选择。这可能会导致网络中的流量模式突然发生意想不到的变化，从而可能造成拥塞。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Given that these mechanisms can only be enabled through configuration of routers within a single network, standard security measures should be taken to restrict access to the management interface(s) of routers that implement these mechanisms. Additionally, BGP sessions SHOULD be protected using TCP Authentication Option [RFC5925] and the Generalized TTL Security Mechanism [RFC5082]
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
鉴于这些机制只能通过配置单个网络中的路由器来启用，因此应采取标准的安全措施来限制对实施这些机制的路由器管理界面的访问。此外，应使用 TCP 验证选项 [RFC5925] 和通用 TTL 安全机制 [RFC5082] 保护 BGP 会话。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="7--References">
7. References
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7. 参考文献
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="7-1--Normative-References">
7.1. Normative References
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.1. 规范性文献
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC2119] Bradner, S., &#34;Key words for use in RFCs to Indicate Requirement Levels&#34;, BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997, &lt;http://www.rfc-editor.org/info/rfc2119&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC2119] Bradner, S., &#34;Key words for use in RFCs to Indicate Requirement Levels&#34;, BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997, &lt;http://www.rfc-editor.org/info/rfc2119&gt;.
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC4271] Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., &#34;A Border Gateway Protocol 4 (BGP-4)&#34;, RFC 4271, DOI 10.17487/RFC4271, January 2006, &lt;http://www.rfc-editor.org/info/rfc4271&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC4271] Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., &#34;A Border Gateway Protocol 4 (BGP-4)&#34;, RFC 4271, DOI 10.17487/RFC4271, January 2006, &lt;http://www.rfc-editor.org/info/rfc4271&gt;.
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC4456] Bates, T., Chen, E., and R. Chandra, &#34;BGP Route Reflection: An Alternative to Full Mesh Internal BGP (IBGP)&#34;, RFC 4456, DOI 10.17487/RFC4456, April 2006, &lt;http://www.rfc-editor.org/info/rfc4456&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC4456] Bates, T., Chen, E., and R. Chandra, &#34;BGP Route Reflection：An Alternative to Full Mesh Internal BGP (IBGP)&#34;, RFC 4456, DOI 10.17487/RFC4456, April 2006, &lt;http://www.rfc-editor.org/info/rfc4456&gt;.
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="7-2--Informative-References">
7.2. Informative References
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
7.2. 参考性文献
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[ALU] Alcatel-Lucent, &#34;BGP Local AS attribute&#34;, 2006-2012, &lt;https://infoproducts.alcatel-lucent.com/html/0_add-h-f/ 93-0074-10-01/7750_SR_OS_Routing_Protocols_Guide/ BGP-CLI.html#709567&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[ALU] Alcatel-Lucent, &#34;BGP Local AS attribute&#34;, 2006-2012, &lt;https://infoproducts.alcatel-lucent.com/html/0_add-h-f/ 93-0074-10-01/7750_SR_OS_Routing_Protocols_Guide/ BGP-CLI.html#709567&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[CISCO] Cisco Systems, Inc., &#34;BGP Support for Dual AS Configuration for Network AS Migrations&#34;, 2013, &lt;http://www.cisco.com/c/en/us/td/docs/ios-xml/ ios/iproute_bgp/configuration/xe-3s/asr1000/ irg-xe-3s-asr1000-book/irg-dual-as.html&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[CISCO] Cisco Systems, Inc., &#34;BGP Support for Dual AS Configuration for Network AS Migrations&#34;, 2013, &lt;http://www.cisco.com/c/en/us/td/docs/ios-xml/ ios/iproute_bgp/configuration/xe-3s/asr1000/irg-xe-3s-asr1000-book/irg-dual-as.html&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[JUNIPER] Juniper Networks, Inc., &#34;Understanding the BGP Local AS Attribute&#34;, December 2013, &lt;http://www.juniper.net/techpubs/en_US/junos13.3/topics/ concept/bgp-local-as-introduction.html&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[JUNIPER] 瞻博网络公司，&#34;了解 BGP 本地 AS 属性&#34;，2013 年 12 月，&lt;http://www.juniper.net/techpubs/en_US/junos13.3/topics/ concept/bgp-local-as-introduction.html&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC5065] Traina, P., McPherson, D., and J. Scudder, &#34;Autonomous System Confederations for BGP&#34;, RFC 5065, DOI 10.17487/RFC5065, August 2007, &lt;http://www.rfc-editor.org/info/rfc5065&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC5065] Traina, P., McPherson, D., and J. Scudder, &#34;Autonomous System Confederations for BGP&#34;, RFC 5065, DOI 10.17487/RFC5065, August 2007, &lt;http://www.rfc-editor.org/info/rfc5065&gt;.
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC5082] Gill, V., Heasley, J., Meyer, D., Savola, P., Ed., and C. Pignataro, &#34;The Generalized TTL Security Mechanism (GTSM)&#34;, RFC 5082, DOI 10.17487/RFC5082, October 2007, &lt;http://www.rfc-editor.org/info/rfc5082&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC5082] Gill, V., Heasley, J., Meyer, D., Savola, P., Ed., and C. Pignataro, &#34;The Generalized TTL Security Mechanism (GTSM)&#34;, RFC 5082, DOI 10.17487/RFC5082, October 2007, &lt;http://www.rfc-editor.org/info/rfc5082&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC5398] Huston, G., &#34;Autonomous System (AS) Number Reservation for Documentation Use&#34;, RFC 5398, DOI 10.17487/RFC5398, December 2008, &lt;http://www.rfc-editor.org/info/rfc5398&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC5398] Huston, G., &#34;Autonomous System (AS) Number Reservation for Documentation Use&#34;, RFC 5398, DOI 10.17487/RFC5398, December 2008, &lt;http://www.rfc-editor.org/info/rfc5398&gt;.
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC5925] Touch, J., Mankin, A., and R. Bonica, &#34;The TCP Authentication Option&#34;, RFC 5925, DOI 10.17487/RFC5925, June 2010, &lt;http://www.rfc-editor.org/info/rfc5925&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC5925] Touch, J., Mankin, A., and R. Bonica, &#34;The TCP Authentication Option&#34;, RFC 5925, DOI 10.17487/RFC5925, June 2010, &lt;http://www.rfc-editor.org/info/rfc5925&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC6793] Vohra, Q. and E. Chen, &#34;BGP Support for Four-Octet Autonomous System (AS) Number Space&#34;, RFC 6793, DOI 10.17487/RFC6793, December 2012, &lt;http://www.rfc-editor.org/info/rfc6793&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC6793] Vohra, Q. and E. Chen, &#34;BGP Support for Four-Octet Autonomous System (AS) Number Space&#34;, RFC 6793, DOI 10.17487/RFC6793, December 2012, &lt;http://www.rfc-editor.org/info/rfc6793&gt;.
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC6996] Mitchell, J., &#34;Autonomous System (AS) Reservation for Private Use&#34;, BCP 6, RFC 6996, DOI 10.17487/RFC6996, July 2013, &lt;http://www.rfc-editor.org/info/rfc6996&gt;.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
[RFC6996] Mitchell, J., &#34;Autonomous System (AS) Reservation for Private Use&#34;, BCP 6, RFC 6996, DOI 10.17487/RFC6996, July 2013, &lt;http://www.rfc-editor.org/info/rfc6996&gt;。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2" id="Appendix-A--Implementation-Report">
Appendix A. Implementation Report
        </h5>
      </div>
      <div class="col-sm-12 col-md-6">
        <h5 class="text mt-2">
附录A. 实施报告
        </h5>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
As noted elsewhere in this document, this set of migration mechanisms has multiple existing implementations in wide use.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
正如本文件其他部分所指出的，这套迁移机制有多种现有的实施方案，并得到广泛应用。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
o Cisco [CISCO]
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
o 思科 [CISCO]
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
o Juniper [JUNIPER]
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
o 瞻博网络 [JUNIPER］
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
o Alcatel-Lucent [ALU]
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
o 阿尔卡特朗讯 [ALU]
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
This is not intended to be an exhaustive list, as equivalent features do exist in other implementations; however, the authors were unable to find publicly available documentation of the vendor-specific implementation to reference.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
这并不是一份详尽无遗的清单，因为在其他实现中也存在等效功能；不过，作者无法找到公开的供应商特定实现文档作为参考。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
Acknowledgements
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
致谢
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Thanks to Kotikalapudi Sriram, Stephane Litkowski, Terry Manderson, David Farmer, Jaroslaw Adam Gralak, Gunter Van de Velde, Juan Alcaide, Jon Mitchell, Thomas Morin, Alia Atlas, Alvaro Retana, and John Scudder for their comments.
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
感谢 Kotikalapudi Sriram、Stephane Litkowski、Terry Manderson、David Farmer、Jaroslaw Adam Gralak、Gunter Van de Velde、Juan Alcaide、Jon Mitchell、Thomas Morin、Alia Atlas、Alvaro Retana 和 John Scudder 的意见。
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
Authors&#39; Addresses
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-0">
作者地址
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Wesley George Time Warner Cable 13820 Sunrise Valley Drive Herndon, VA 20171 United States
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Wesley George Time Warner Cable 13820 Sunrise Valley Drive Herndon, VA 20171 美国
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
   Phone: +1 703-561-2540
   Email: wesley.george@twcable.com
        </pre>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
Shane Amante Apple, Inc. 1 Infinite Loop Cupertino, CA 95014 United States
        </p>
      </div>
      <div class="col-sm-12 col-md-6">
        <p class="text indent-3">
苹果公司1 Infinite Loop Cupertino, CA 95014 美国
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12">
        <pre class="text text-monospace">
   Email: amante@apple.com
        </pre>
      </div>

    </div>
  </div>
  <div id="rfc_footer"></div>
</body>
</html>
